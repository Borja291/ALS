{% extends "layout.html" %} {# Hereda la estructura y estilos base #}

{% block extra_body_class %}fondo-inicio{% endblock %} {# AÃ±ade clase para aplicar fondo especÃ­fico de la vista de inicio #}

{% block title %}Inicio - CineMate{% endblock %} {# TÃ­tulo de la pestaÃ±a del navegador #}

{% block content %} {# Inicio del contenido principal de la pÃ¡gina #}

{% if current_user.is_authenticated %} {# Si el usuario ha iniciado sesiÃ³n #}

<!-- SecciÃ³n de bienvenida -->
<div class="section text-center">
    <h1>Â¡Bienvenido a CineMate!</h1>
    <p>Hola, <strong>{{ current_user.username }}</strong> ğŸ‘‹</p>
    <p>Â¡Empieza a registrar las pelÃ­culas que has visto o crea tus listas!</p>

    <!-- BotÃ³n para explorar todas las pelÃ­culas disponibles -->
    <a href="{{ url_for('explore.all_movies') }}" class="btn btn-success mt-3">
        ğŸŒ Ver todas las pelÃ­culas en CineMate
    </a>
</div>

<!-- SecciÃ³n de pelÃ­culas personales del usuario -->
<div class="section">
    <h2 class="text-center mb-4 txt-tusPelis">ğŸ¬ Tus pelÃ­culas</h2>

    {% if movies %} {# Si el usuario tiene pelÃ­culas guardadas #}
    <div class="row">
        {% for movie in movies %} {# Recorre cada pelÃ­cula del usuario #}
        <div class="col-md-6 col-lg-4 mb-4">
            <div class="card h-100 text-light card-dark">

                <!-- Cuerpo de la tarjeta con botones -->
                <div class="card-body d-flex flex-column">

                    <!-- BotÃ³n para eliminar pelÃ­cula, abre modal -->
                    <button class="btn btn-danger btn-sm position-absolute top-0 end-0 m-2" data-bs-toggle="modal"
                        data-bs-target="#confirmDeleteMovieModal" data-movie-title="{{ movie.title }}"
                        data-delete-url="{{ url_for('movies.delete_movie', movie_id=movie.id) }}">
                        ğŸ—‘ï¸
                    </button>

                    <!-- TÃ­tulo de la pelÃ­cula -->
                    <h5 class="card-title fw-bold">{{ movie.title }} ({{ movie.year }})</h5>

                    <!-- GÃ©nero y fecha vista -->
                    <p class="card-text text-muted-light">
                        {{ movie.genre }} â€“ Vista el {{ movie.date_watched }}
                    </p>

                    <!-- Botones para reseÃ±ar o ver reseÃ±a -->
                    <div class="d-flex justify-content-end gap-2 mt-3">
                        <a href="{{ url_for('reviews.review_movie', movie_id=movie.id) }}"
                            class="btn btn-warning btn-sm btn-circle" title="ReseÃ±ar">
                            âœï¸
                        </a>

                        <a href="{{ url_for('reviews.view_review', movie_id=movie.id) }}"
                            class="btn btn-look-review btn-sm btn-circle" title="Ver tu reseÃ±a">
                            ğŸ”
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    {% else %} {# Si el usuario no ha aÃ±adido pelÃ­culas aÃºn #}
    <p class="text-center mt-4">AÃºn no has aÃ±adido ninguna pelÃ­cula.</p>
    {% endif %}

    <!-- BotÃ³n para aÃ±adir una nueva pelÃ­cula -->
    <div class="text-center mt-4">
        <a href="{{ url_for('movies.add_movie_decision') }}" class="btn btn-success">
            â• AÃ±adir una nueva pelÃ­cula
        </a>
    </div>
</div>

<!-- SecciÃ³n de listas temÃ¡ticas del usuario -->
<div class="section text-center">
    <h2>ğŸ“‹ Listas temÃ¡ticas</h2>
    <div class="d-grid gap-2 d-md-block mt-3">
        <a href="{{ url_for('lists.view_lists') }}" class="btn btn-outline-light btn-sm">ğŸ“‹ Ver mis listas</a>
        <a href="{{ url_for('lists.create_list') }}" class="btn btn-outline-success btn-sm">â• Crear lista nueva</a>
    </div>
</div>

{% else %} {# Si el usuario no estÃ¡ autenticado #}

<!-- Pantalla de bienvenida para visitantes no registrados -->
<div class="section text-center">
    <h1>Â¡Bienvenido a CineMate!</h1>
    <p>
        <a href="{{ url_for('auth.login') }}" class="btn btn-success">Inicia sesiÃ³n</a> o
        <a href="{{ url_for('auth.register') }}" class="btn btn-primary">RegÃ­strate</a> para comenzar.
    </p>
</div>
{% endif %}

<!-- Modal de confirmaciÃ³n para eliminar pelÃ­cula -->
<div class="modal fade" id="confirmDeleteMovieModal" tabindex="-1" aria-labelledby="confirmDeleteMovieModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content modal-dark">

            <!-- Cabecera del modal -->
            <div class="modal-header">
                <h5 class="modal-title" id="confirmDeleteMovieModalLabel">Confirmar eliminaciÃ³n</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>

            <!-- Cuerpo del modal con el nombre de la pelÃ­cula a eliminar -->
            <div class="modal-body">
                Â¿Seguro que quieres eliminar la pelÃ­cula <span id="movieTitle" class="txt-eliminar"></span>?
            </div>

            <!-- Pie del modal con acciones -->
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <form id="confirmDeleteForm" method="POST">
                    <button type="submit" class="btn btn-danger">SÃ­, eliminar</button>
                </form>
            </div>

        </div>
    </div>
</div>

{% endblock %} {# Fin del contenido principal #}
